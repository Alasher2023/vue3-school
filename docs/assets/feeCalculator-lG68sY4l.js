import{f as x,b as g,a as E,w as L,d as q,s as A,c as D}from"./dropdownData-Ctf36_96.js";import{B as _,h as j,a as u,s as b,f as z,c as n,d as G,e as H,b as M}from"./row.esm-DplezHli.js";import{o as I,a as O,b as w,i as S,m as h,_ as J,r as p,c as U,e as l,f as o,u as a,F as K,q as T,t as $}from"./index-BgKxvRo0.js";import"./inputswitch.esm-BvtKlaVD.js";var Q={root:"p-toolbar p-component",start:"p-toolbar-group-start p-toolbar-group-left",center:"p-toolbar-group-center",end:"p-toolbar-group-end p-toolbar-group-right"},R=_.extend({name:"toolbar",classes:Q}),W={name:"BaseToolbar",extends:j,props:{ariaLabelledby:{type:String,default:null}},style:R,provide:function(){return{$parentInstance:this}}},k={name:"Toolbar",extends:W,inheritAttrs:!1},X=["aria-labelledby"];function Y(s,y,d,C,c,m){return I(),O("div",h({class:s.cx("root"),role:"toolbar","aria-labelledby":s.ariaLabelledby},s.ptmi("root")),[w("div",h({class:s.cx("start")},s.ptm("start")),[S(s.$slots,"start")],16),w("div",h({class:s.cx("center")},s.ptm("center")),[S(s.$slots,"center")],16),w("div",h({class:s.cx("end")},s.ptm("end")),[S(s.$slots,"end")],16)],16,X)}k.render=Y;var Z={root:"p-inputgroup-addon"};_.extend({name:"inputgroupaddon",classes:Z});const ee={__name:"feeCalculator",setup(s){const y=p("乐器"),d=p(""),C=U(()=>x.value.filter(r=>r.type===y.value)),c=p(),m=p(),f=p([]),B=()=>{let r=x.value.find(e=>e.text===d.value.text).type,t=1;r==="其他"?d.value.text==="介绍费"?t=99:t=98:r==="个人指导120分钟"||r==="个人指导90分钟"||r==="个人指导60分钟"?t=parseInt(d.value.text.substring(1,2)):t=1,f.value.push({id:t,lessonName:d.value.text,lessonPrice:d.value.price,enlistsTimes:x.value.find(e=>e.text===d.value.text).type==="其他"?1:4,restTimes:0,spOffer:1})},F=()=>{f.value.push({id:99,lessonName:c.value,lessonPrice:m.value,enlistsTimes:1,restTimes:0,spOffer:1}),c.value="",m.value="",V.value=!1},N=r=>{let{data:t,newValue:e,field:i}=r;t[i]=e};p([]);const P=U(()=>{let r=0;return f.value.forEach(t=>{let e=t.id===99?parseInt(t.lessonPrice):t.id===98?Math.floor(t.lessonPrice*1.1):t.lessonPrice>=0?Math.floor(t.lessonPrice*1.1)/(4*t.id)*(t.enlistsTimes*t.id-t.restTimes)*t.spOffer:Math.floor(Math.abs(t.lessonPrice)*1.1)/(4*t.id)*(t.enlistsTimes*t.id-t.restTimes)*t.spOffer*-1;r+=e}),r.toLocaleString()}),V=p(!1);return(r,t)=>(I(),O(K,null,[l(a(A),null,{content:o(()=>[l(a(k),null,{start:o(()=>[l(a(g),null,{default:o(()=>[l(a(u),{label:"类别"}),l(a(b),{modelValue:y.value,"onUpdate:modelValue":t[0]||(t[0]=e=>y.value=e),options:a(E),"pt:root:class":"wdd-large"},null,8,["modelValue","options"])]),_:1}),l(a(g),{"pt:root:style":"margin-left: 10px"},{default:o(()=>[l(a(u),{label:"项目"}),l(a(b),{modelValue:d.value,"onUpdate:modelValue":t[1]||(t[1]=e=>d.value=e),options:C.value,"option-label":"text","pt:root:class":"wdd-large"},null,8,["modelValue","options"])]),_:1}),l(a(u),{label:"新增",outlined:"",class:"toolbar-btn",onClick:B})]),end:o(()=>[l(a(u),{label:"添加其他",severity:"warning",onClick:t[2]||(t[2]=()=>V.value=!0)})]),_:1}),l(a(z),{value:f.value,tableStyle:"min-width: 58rem",editMode:"cell",onCellEditComplete:N},{default:o(()=>[l(a(n),{field:"lessonName",header:"课程",style:{}}),l(a(n),{field:"lessonPrice",header:"稅前价格"},{body:o(e=>[T($(parseInt(e.data.lessonPrice).toLocaleString()),1)]),_:1}),l(a(n),{field:"lessonTaxPrice",header:"稅後价格",style:{}},{body:o(e=>[T($(e.data.id===99?parseInt(e.data.lessonPrice).toLocaleString():e.data.lessonPrice>=0?Math.floor(e.data.lessonPrice*1.1).toLocaleString():(Math.floor(Math.abs(e.data.lessonPrice)*1.1)*-1).toLocaleString()),1)]),_:1}),l(a(n),{field:"enlistsTimes",header:"报名回数",style:{}},{editor:o(({data:e,field:i})=>[l(a(b),{modelValue:e[i],"onUpdate:modelValue":v=>e[i]=v,options:a(L),optionLabel:"Text","option-value":"Value","pt:root:class":"wdd-normal"},null,8,["modelValue","onUpdate:modelValue","options"])]),_:1}),l(a(n),{field:"restTimes",header:"休息回数",style:{}},{editor:o(({data:e,field:i})=>[l(a(b),{modelValue:e[i],"onUpdate:modelValue":v=>e[i]=v,options:a(L),optionLabel:"Text","option-value":"Value","pt:root:class":"wdd-normal"},null,8,["modelValue","onUpdate:modelValue","options"])]),_:1}),l(a(n),{field:"spOffer",header:"折扣",style:{}},{editor:o(({data:e,field:i})=>[l(a(b),{modelValue:e[i],"onUpdate:modelValue":v=>e[i]=v,options:a(q),optionLabel:"text","option-value":"value","pt:root:class":"wdd-normal"},null,8,["modelValue","onUpdate:modelValue","options"])]),body:o(e=>[T($(e.data.spOffer===1?"无":e.data.spOffer===.95?"95折":"9折"),1)]),_:1}),l(a(n),{field:"price",header:"应缴费用",style:{}},{body:o(e=>[T($(e.data.id===99?parseInt(e.data.lessonPrice).toLocaleString():e.data.id===98?Math.floor(e.data.lessonPrice*1.1).toLocaleString():((Math.floor(Math.abs(e.data.lessonPrice)*1.1)/4*e.data.id*e.data.enlistsTimes*e.data.id-e.data.restTimes*e.data.spOffer)*(e.data.lessonPrice>0?1:-1)).toLocaleString()),1)]),_:1}),l(a(n),{style:{width:"15%"}},{body:o(e=>[l(a(u),{icon:"pi pi-trash",onClick:()=>{f.value.splice(e.index,1)}},null,8,["onClick"]),l(a(u),{style:{margin:"auto 5px"},icon:"pi pi-bitcoin",onClick:()=>{e.data.lessonPrice=0-e.data.lessonPrice}},null,8,["onClick"])]),_:1}),l(a(G),{type:"footer"},{default:o(()=>[l(a(H),null,{default:o(()=>[l(a(n),{footer:"总计:",colspan:6,footerStyle:"text-align:right"}),l(a(n),{footer:P.value},null,8,["footer"])]),_:1})]),_:1})]),_:1},8,["value"])]),_:1}),l(a(D),{visible:V.value,"onUpdate:visible":t[5]||(t[5]=e=>V.value=e),header:"税前价格",modal:"",style:{width:"25rem"}},{default:o(()=>[l(a(g),{style:{margin:"5px auto"}},{default:o(()=>[l(a(u),{label:"项目",severity:"warning"}),l(a(M),{modelValue:c.value,"onUpdate:modelValue":t[3]||(t[3]=e=>c.value=e),style:{width:"10em"},placeholder:"其他项目"},null,8,["modelValue"])]),_:1}),l(a(g),{style:{margin:"5px auto"}},{default:o(()=>[l(a(u),{label:"费用",severity:"warning"}),l(a(M),{modelValue:m.value,"onUpdate:modelValue":t[4]||(t[4]=e=>m.value=e),type:"number",pattern:"[0-9]*",inputmode:"numeric",placeholder:"请输入费用"},null,8,["modelValue"])]),_:1}),l(a(u),{label:"确定",style:{width:"100%"},severity:"",onClick:F})]),_:1},8,["visible"])],64))}},se=J(ee,[["__scopeId","data-v-773491d5"]]);export{se as default};
