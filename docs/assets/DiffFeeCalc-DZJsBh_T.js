import{_ as J,r as p,c as k,w as Q,o as d,a as c,b as e,e as n,f as v,u as o,h as W,v as X,F as m,E as f,t as a,i as V,j as i,B as S,p as Y,g as Z,K as ee}from"./index-3_CvEBpC.js";import{s as D,a as g,b as O,i as le}from"./focustrap.esm-CWZGsNbM.js";import{f as te,a as se,s as B,c as R,b as oe,w as ne}from"./dropdownData-FCHCWmqh.js";import{s as E}from"./inputgroupaddon.esm-Be1MXtoP.js";import{s as ae}from"./dataview.esm-DW03ntbC.js";import{s as ie}from"./divider.esm-DUNKPPmp.js";const s=L=>(Y("data-v-601d19a1"),L=L(),Z(),L),re={style:{height:"100svh",margin:"0",padding:"0","box-sizing":"border-box"}},ue={style:{display:"flex","flex-direction":"column",gap:"0.5rem",height:"100%"}},de={style:{display:"grid","grid-template-columns":"40% 60%","align-items":"center",gap:"0.5rem"}},ce=s(()=>e("span",null,"课程类别",-1)),pe=s(()=>e("span",null,"课程名",-1)),ve={style:{display:"flex","flex-direction":"row",gap:"0.5rem"}},me={style:{display:"grid","grid-template-columns":"40% 60%","align-items":"center",gap:"0.5rem"}},_e=s(()=>e("div",{style:{display:"flex","flex-direction":"row",gap:"0.5rem"}},null,-1)),he={style:{display:"flex","flex-direction":"row",gap:"0.5rem"}},fe=s(()=>e("span",{style:{"font-size":"x-large"}},"总价:",-1)),ge={style:{flex:"1 1 0%","text-align":"right","font-size":"x-large"}},ye={class:"div-dataview"},be=s(()=>e("label",null,"课程价格(稅前)",-1)),xe=s(()=>e("label",null,"课程价格(稅后)",-1)),we={class:"div-dataview"},Ve=s(()=>e("label",null,"休息回数",-1)),Le={style:{display:"flex","align-items":"center",gap:"0.5rem"}},Te={style:{"margin-left":"auto","font-size":"large"}},Pe=s(()=>e("footer",{style:{height:"0.5rem",flex:"none"}},null,-1)),ke={style:{display:"grid","grid-template-columns":"10% 90%",gap:"0.5rem","align-items":"center"}},Se=s(()=>e("label",{for:"otherItemName"},"项目",-1)),Ne=s(()=>e("label",{for:"otherItemValue"},"费用",-1)),Ie=s(()=>e("br",null,null,-1)),Ce=s(()=>e("br",null,null,-1)),Me=s(()=>e("br",null,null,-1)),Fe=s(()=>e("br",null,null,-1)),Ue=s(()=>e("br",null,null,-1)),$e=s(()=>e("br",null,null,-1)),De=s(()=>e("br",null,null,-1)),Oe=s(()=>e("br",null,null,-1)),ze=s(()=>e("br",null,null,-1)),Be=s(()=>e("br",null,null,-1)),Re=s(()=>e("br",null,null,-1)),Ee=s(()=>e("br",null,null,-1)),je=s(()=>e("br",null,null,-1)),Ke=s(()=>e("br",null,null,-1)),qe={style:{display:"flex","flex-direction":"column",gap:"0.25rem"}},Ae=s(()=>e("span",null,"11月",-1)),Ge={style:{display:"grid","grid-template-columns":"50% 15% 35%"}},He={style:{"grid-column-start":"3"}},Je=s(()=>e("span",null,"12月",-1)),Qe=s(()=>e("span",null,null,-1)),We={style:{display:"grid","grid-template-columns":"50% 15% 35%"}},Xe={style:{"grid-column-start":"3"}},Ye=s(()=>e("br",null,null,-1)),Ze={style:{display:"grid","grid-template-columns":"50% 15% 35%"}},el=s(()=>e("span",null,"12月费用 - 11月休总额",-1)),ll={style:{"grid-column-start":"3"}},tl=s(()=>e("br",null,null,-1)),sl={__name:"DiffFeeCalc",setup(L){const _=p([]),N=p("音乐"),h=p(""),j=k(()=>te.value.filter(u=>u.type===N.value)),K=()=>{_.value.push({id:_.value.length+1,lessonName:h.value.text,lessonPrice:h.value.price,lessonTaxPrice:parseInt(h.value.price*1.1),enlistsTimes:h.value.times,restTimes:0,totalPrice:parseInt(h.value.price*1.1),isLastMonth:!1,isOtherFee:!1})},q=u=>{_.value.splice(u,1)};Q(_,u=>{console.debug("watchdata:",u),u.map(l=>{l.totalPrice=Math.floor(l.isLastMonth?l.lessonPrice/l.enlistsTimes*l.restTimes*1.1:l.lessonPrice/l.enlistsTimes*(l.enlistsTimes-l.restTimes)*1.1)}),b.value=u.filter(l=>l.isLastMonth===!0),x.value=u.filter(l=>l.isLastMonth===!1)},{deep:!0});const y=p(!1),I=p(null),w=p(null),A=()=>{_.value.push({id:_.value.length+1,lessonName:I.value,lessonPrice:w.value,lessonTaxPrice:parseInt(w.value),enlistsTimes:1,restTimes:0,totalPrice:parseInt(w.value),isLastMonth:!1,isOtherFee:!0}),y.value=!y.value},T=p(!1),C=p(""),P=p(!1),b=p([]),x=p([]),M=p(null),F=k(()=>(console.debug("computerLastPrice:",b.value),b.value.reduce((u,l)=>u+(l==null?void 0:l.totalPrice),0))),U=k(()=>(console.debug("computerNowPrice:",x.value),x.value.reduce((u,l)=>u+(l==null?void 0:l.totalPrice),0))),$=k(()=>(console.debug("computerTotalPrice"),U.value-F.value)),G=async()=>{if(M.value){const u=M.value.innerText;try{await navigator.clipboard.writeText(u),window.location.href="weixin://"}catch(l){console.error("复制失败:",l)}}};return(u,l)=>(d(),c(m,null,[e("div",re,[e("div",ue,[n(o(B),{style:{flex:"none"}},{content:v(()=>[e("div",de,[ce,n(o(D),{modelValue:N.value,"onUpdate:modelValue":l[0]||(l[0]=t=>N.value=t),options:o(se)},null,8,["modelValue","options"]),pe,n(o(D),{modelValue:h.value,"onUpdate:modelValue":l[1]||(l[1]=t=>h.value=t),options:j.value,"option-label":"text",placeholder:"请选择课程"},null,8,["modelValue","options"]),e("div",ve,[n(o(g),{icon:"pi pi-fw pi-box",onClick:l[2]||(l[2]=f(()=>y.value=!y.value,["prevent"]))}),n(o(g),{icon:"pi pi-fw pi-send",onClick:l[3]||(l[3]=f(()=>T.value=!T.value,["prevent"]))})]),n(o(g),{label:"添加",icon:"pi pi-plus",onClick:f(K,["prevent"])})])]),footer:v(()=>[e("div",me,[_e,e("div",he,[fe,e("span",ge,a($.value)+"円",1)])])]),_:1}),W(n(o(ae),{value:_.value,style:{flex:"1 1 0%",overflow:"auto"}},{list:v(t=>[(d(!0),c(m,null,V(t.items,(r,H)=>(d(),c("div",{key:r.id},[n(o(ie)),n(o(B),{style:{width:"100%",overflow:"hidden"}},ee({title:v(()=>[i(a(r.lessonName),1)]),subtitle:v(()=>[e("div",ye,[be,e("span",null,a(r.lessonPrice.toLocaleString()),1),xe,e("span",null,a(r.lessonTaxPrice.toLocaleString()),1)])]),footer:v(()=>[e("div",Le,[n(o(g),{label:r.isLastMonth?"11月":"12月",onClick:f(()=>r.isLastMonth=!r.isLastMonth,["prevent"])},null,8,["label","onClick"]),n(o(g),{label:"删除",onClick:f(z=>q(H),["prevent"])},null,8,["onClick"]),e("div",Te,[e("b",null,a(r.isLastMonth?"应退费用":"应缴费用")+":"+a(r.totalPrice.toLocaleString()),1)])])]),_:2},[r.isOtherFee?void 0:{name:"content",fn:v(()=>[e("div",we,[Ve,n(o(D),{modelValue:r.restTimes,"onUpdate:modelValue":z=>r.restTimes=z,options:o(ne),optionLabel:"Text","option-value":"Value"},null,8,["modelValue","onUpdate:modelValue","options"])])]),key:"0"}]),1024)]))),128))]),_:1},8,["value"]),[[X,_.value.length>0]]),Pe])]),n(o(R),{visible:y.value,"onUpdate:visible":l[6]||(l[6]=t=>y.value=t),header:"添加自定义项目",modal:"",style:{width:"25rem"}},{default:v(()=>[e("div",ke,[Se,n(o(O),{name:"otherItemName",modelValue:I.value,"onUpdate:modelValue":l[4]||(l[4]=t=>I.value=t),placeholder:"其他项目"},null,8,["modelValue"]),Ne,n(o(O),{name:"otherItemValue",modelValue:w.value,"onUpdate:modelValue":l[5]||(l[5]=t=>w.value=t),type:"number",pattern:"[0-9]*",inputmode:"numeric",placeholder:"请输入费用"},null,8,["modelValue"]),n(o(g),{label:"确定",style:{"grid-column":"1","grid-column-end":"3"},onClick:f(A,["prevent"])})])]),_:1},8,["visible"]),n(o(R),{visible:T.value,"onUpdate:visible":l[9]||(l[9]=t=>T.value=t),modal:"",header:"费用账单",style:{width:"25rem"}},{default:v(()=>[e("div",{style:{display:"none"},ref_key:"dialogContent",ref:M},[i(a(C.value)+"  家长：您好！ ",1),Ie,Ce,P.value?(d(),c(m,{key:0},[i(" 12月费用稍有上调,明细如下 "),Me,Fe],64)):S("",!0),b.value.length>0?(d(),c(m,{key:1},[i(" 11月 "),Ue,(d(!0),c(m,null,V(b.value,(t,r)=>(d(),c(m,{key:r},[i(a(t.lessonName)+"  休 "+a(t.restTimes)+"  费用 "+a(t.totalPrice.toLocaleString())+" 円 ",1),$e],64))),128)),i(" 总计 "+a(F.value.toLocaleString())+" 円 ",1)],64)):S("",!0),De,Oe,x.value.length>0?(d(),c(m,{key:2},[i(" 12月 "),ze,(d(!0),c(m,null,V(x.value,(t,r)=>(d(),c(m,{key:r},[i(a(t.lessonName)+"  费用 "+a(t.totalPrice.toLocaleString())+" 円 ",1),Be],64))),128)),Re,i(" 总计 "+a(U.value.toLocaleString())+" 円 ",1),Ee],64)):S("",!0),je,P.value?(d(),c(m,{key:3},[i(" 12月费用 - 11月休总额 ")],64)):S("",!0),Ke,i(" 12月费用应付 "+a($.value.toLocaleString())+" 円，请您确认 ",1)],512),e("div",qe,[Ae,(d(!0),c(m,null,V(b.value,(t,r)=>(d(),c("div",{key:r,style:{display:"grid","grid-template-columns":"50% 15% 35%"}},[e("span",null,a(t.lessonName),1),e("span",null,[i("休 "),e("u",null,a(t.restTimes),1)]),e("span",null,[i("费用 "),e("u",null,a(t.totalPrice.toLocaleString()),1),i(" 円")])]))),128)),e("div",Ge,[e("span",He,[i("合计 "),e("u",null,a(F.value.toLocaleString()),1),i(" 円")])]),Je,(d(!0),c(m,null,V(x.value,(t,r)=>(d(),c("div",{key:r,style:{display:"grid","grid-template-columns":"50% 15% 35%"}},[e("span",null,a(t.lessonName),1),Qe,e("span",null,[i("费用 "),e("u",null,a(t.totalPrice.toLocaleString()),1),i(" 円")])]))),128)),e("div",We,[e("span",Xe,[i("合计 "),e("u",null,a(U.value.toLocaleString()),1),i(" 円")])]),Ye,e("div",Ze,[el,e("span",ll,[i("总计 "),e("u",null,a($.value.toLocaleString()),1),i(" 円")])])]),tl,n(o(oe),null,{default:v(()=>[n(o(E),null,{default:v(()=>[n(o(le),{modelValue:P.value,"onUpdate:modelValue":l[7]||(l[7]=t=>P.value=t),binary:!0},null,8,["modelValue"])]),_:1}),n(o(O),{type:"text",modelValue:C.value,"onUpdate:modelValue":l[8]||(l[8]=t=>C.value=t),placeholder:"学生姓名"},null,8,["modelValue"]),n(o(E),null,{default:v(()=>[n(o(g),{icon:"pi pi-fw pi-send",onClick:f(G,["prevent"])})]),_:1})]),_:1})]),_:1},8,["visible"])],64))}},dl=J(sl,[["__scopeId","data-v-601d19a1"]]);export{dl as default};
